
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Engine Activity Extension &#8212; Level Zero Specification  documentation</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-book-theme.css?digest=84ace793992934648b4de8eed757e5a2" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx-book-theme.9d8b4a8b9bb19db25eeaddc40d639ba2.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<div class="col-12 col-md-3 bd-sidebar site-navigation " id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
      
      
      <h1 class="site-logo" id="site-title">Level Zero Specification  documentation</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../core/INTRO.html">
   Introduction
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../core/PROG.html">
   Core Programming Guide
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../tools/PROG.html">
   Tools Programming Guide
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="PROG.html">
   Sysman Programming Guide
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../core/SPIRV.html">
   SPIR-V Programming Guide
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../core/EXT.html">
   Extensions
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../api.html">
   API Documentation
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../core/api.html">
     Core API
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../tools/api.html">
     Tools API
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="api.html">
     Sysman API
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../versions.html">
   Versions
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Theme by the <a href="https://ebp.jupyterbook.org">Executable Book Project</a>
</div>

</div>


          


          
<!-- This is an invisible pixel that we watch to see if we've scrolled. -->
<div class="sbt-scroll-pixel-helper"></div>
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            <div class="topbar-left">
                
                <label class="nav-toggle-button" for="__navigation">
                    <div class="visually-hidden">Toggle navigation</div>
                    <i class="fas fa-bars"></i>
                </label>
                
            </div>
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/sysman/EXT_EngineActivity.rst.txt"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.rst</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#api">
   API
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#engine-activity">
     Engine Activity
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Engine Activity Extension</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#api">
   API
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#engine-activity">
     Engine Activity
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="section" id="engine-activity-extension">
<span id="zes-extension-engine-activity"></span><h1>Engine Activity Extension<a class="headerlink" href="#engine-activity-extension" title="Permalink to this headline">¶</a></h1>
<div class="section" id="api">
<h2>API<a class="headerlink" href="#api" title="Permalink to this headline">¶</a></h2>
<ul>
<li><p>Functions</p>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference internal" href="api.html#zesenginegetactivityext"><span class="std std-ref">zesEngineGetActivityExt</span></a></p></li>
</ul>
</div></blockquote>
</li>
<li><p>Structures</p>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference internal" href="api.html#zes-engine-ext-properties-t"><span class="std std-ref">zes_engine_ext_properties_t</span></a></p></li>
</ul>
</div></blockquote>
</li>
</ul>
<div class="section" id="engine-activity">
<h3>Engine Activity<a class="headerlink" href="#engine-activity" title="Permalink to this headline">¶</a></h3>
<p>This extension provides capability to user to gather the activity stats for each Virtual Function (VF) associated with engine group.
Intended use case of the feature is to query utilization stats from Physical Function (PF) interface. However, the extension
may return error code <a class="reference internal" href="../core/api.html#ze-result-t"><span class="std std-ref">ZE_RESULT_ERROR_UNSUPPORTED_FEATURE</span></a> if an environment does not support it.
If VF has no activity value to report, then implementation shall reflect that appropriately in <a class="reference internal" href="api.html#zes-engine-stats-t"><span class="std std-ref">zes_engine_stats_t</span></a> struct so that percentage
calculation results in value of 0.
If PF has no activity value to report, then implementation shall reflect that appropriately in <a class="reference internal" href="api.html#zes-engine-stats-t"><span class="std std-ref">zes_engine_stats_t</span></a> struct which is
at index 0 of the output vector such that utilization calculation results in value of 0.</p>
<p>The following pseudo-code demonstrates a sequence for obtaining the engine activity for all Virtual Functions from Physical Function environment:</p>
<pre class="literal-block">// Query for engine properties and gather number of virtual function instances by passing extension structure.
// Number of VFs is per engine handle and equates to number of VFs actively using
// the resource represented by the engine handle.
// Together with pCount from GetActivityExt, user can gather the full view of engine
// utilization for all VFs and PF as shown below

<a class="reference internal" href="api.html#zes-engine-properties-t"><span class="std std-ref">zes_engine_properties_t</span></a> engineProps;
<a class="reference internal" href="api.html#zes-engine-ext-properties-t"><span class="std std-ref">zes_engine_ext_properties_t</span></a> engineExtProps;
engineProps.stype = ZES_STRUCTURE_TYPE_ENGINE_PROPERTIES;
engineProps.pNext = &amp;engineExtProps;
engineExtProps.stype = ZES_STRUCTURE_TYPE_ENGINE_EXT_PROPERTIES;

<a class="reference internal" href="api.html#zesenginegetproperties"><span class="std std-ref">zesEngineGetProperties</span></a>(hEngine, &amp;engineProps);

// Query count of engine stats to gather
// this count is inclusive of PF and N number of VFs
// i.e. if engineStatCount = 4, then this implies, one PF engine stat at index 0
//      of output vector followed by engine stats for 3 VFs
uint32_t engineStatCount = 0;
{s}EngineGetActivityExt(hEngine, &amp;engineStatCount, nullptr);

// Gather engine stats for all VFs and PF.
// Gather two snapshots of engine activity and calculate percentage
// utilization per formula in <a class="reference internal" href="api.html#zes-engine-stats-t"><span class="std std-ref">zes_engine_stats_t</span></a>
<a class="reference internal" href="api.html#zes-engine-stats-t"><span class="std std-ref">zes_engine_stats_t</span></a>* engineStats0 = (<a class="reference internal" href="api.html#zes-engine-stats-t"><span class="std std-ref">zes_engine_stats_t</span></a>*) allocate(engineStatCount * sizeof(<a class="reference internal" href="api.html#zes-engine-stats-t"><span class="std std-ref">zes_engine_stats_t</span></a>));
{s}EngineGetActivityExt(hEngine, &amp;engineStatCount, engineStats0);
sleep(1);
<a class="reference internal" href="api.html#zes-engine-stats-t"><span class="std std-ref">zes_engine_stats_t</span></a>* engineStats1 = (<a class="reference internal" href="api.html#zes-engine-stats-t"><span class="std std-ref">zes_engine_stats_t</span></a>*) allocate(engineStatCount * sizeof(<a class="reference internal" href="api.html#zes-engine-stats-t"><span class="std std-ref">zes_engine_stats_t</span></a>));
{s}EngineGetActivityExt(hEngine, &amp;engineStatCount, engineStats1);

for (uint32_t idx = 0; idx &lt; engineStatCount; ++idx) {
    double utilization = (engineStats1[idx].activeTime - engineStats0[idx].activeTime)/(engineStats1[idx].timestamp - engineStats0[idx].timestamp);
    output(&quot;%s Utilization of engine type pertaining to this handle = %.2fn&quot;, (idx == 0) ? &quot;PF&quot; : &quot;VF&quot;, utilization);
}</pre>
</div>
</div>
</div>


              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Intel<br/>
    
        &copy; Copyright 2024, Intel.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>