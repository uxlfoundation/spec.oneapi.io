
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Bindless Image Experimental Extension &#8212; Level Zero Specification  documentation</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-book-theme.css?digest=84ace793992934648b4de8eed757e5a2" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx-book-theme.9d8b4a8b9bb19db25eeaddc40d639ba2.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<div class="col-12 col-md-3 bd-sidebar site-navigation " id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
      
      
      <h1 class="site-logo" id="site-title">Level Zero Specification  documentation</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="INTRO.html">
   Introduction
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="PROG.html">
   Core Programming Guide
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../tools/PROG.html">
   Tools Programming Guide
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../sysman/PROG.html">
   Sysman Programming Guide
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="SPIRV.html">
   SPIR-V Programming Guide
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="EXT.html">
   Extensions
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../api.html">
   API Documentation
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="api.html">
     Core API
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../tools/api.html">
     Tools API
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../sysman/api.html">
     Sysman API
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../versions.html">
   Versions
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Theme by the <a href="https://ebp.jupyterbook.org">Executable Book Project</a>
</div>

</div>


          


          
<!-- This is an invisible pixel that we watch to see if we've scrolled. -->
<div class="sbt-scroll-pixel-helper"></div>
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            <div class="topbar-left">
                
                <label class="nav-toggle-button" for="__navigation">
                    <div class="visually-hidden">Toggle navigation</div>
                    <i class="fas fa-bars"></i>
                </label>
                
            </div>
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/core/EXT_EXP_BindlessImages.rst.txt"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.rst</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#api">
   API
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#bindless-images">
     Bindless Images
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#programming-example-with-bindless-images">
     Programming example with Bindless images
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#programming-example-with-pitched-memory-usage">
     Programming example with pitched memory usage
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Bindless Image Experimental Extension</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#api">
   API
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#bindless-images">
     Bindless Images
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#programming-example-with-bindless-images">
     Programming example with Bindless images
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#programming-example-with-pitched-memory-usage">
     Programming example with pitched memory usage
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="section" id="bindless-image-experimental-extension">
<span id="ze-experimental-bindless-image"></span><h1>Bindless Image Experimental Extension<a class="headerlink" href="#bindless-image-experimental-extension" title="Permalink to this headline">¶</a></h1>
<div class="section" id="api">
<h2>API<a class="headerlink" href="#api" title="Permalink to this headline">¶</a></h2>
<ul>
<li><p>Enumerations</p>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference internal" href="api.html#ze-bindless-image-exp-version-t"><span class="std std-ref">ze_bindless_image_exp_version_t</span></a></p></li>
<li><p><a class="reference internal" href="api.html#ze-image-bindless-exp-flags-t"><span class="std std-ref">ze_image_bindless_exp_flags_t</span></a></p></li>
</ul>
</div></blockquote>
</li>
<li><p>Structures</p>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference internal" href="api.html#ze-device-pitched-alloc-exp-properties-t"><span class="std std-ref">ze_device_pitched_alloc_exp_properties_t</span></a></p></li>
<li><p><a class="reference internal" href="api.html#ze-image-bindless-exp-desc-t"><span class="std std-ref">ze_image_bindless_exp_desc_t</span></a></p></li>
<li><p><a class="reference internal" href="api.html#ze-image-pitched-exp-desc-t"><span class="std std-ref">ze_image_pitched_exp_desc_t</span></a></p></li>
</ul>
</div></blockquote>
</li>
<li><p>Functions</p>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference internal" href="api.html#zememgetpitchfor2dimage"><span class="std std-ref">zeMemGetPitchFor2dImage</span></a></p></li>
<li><p><a class="reference internal" href="api.html#zeimagegetdeviceoffsetexp"><span class="std std-ref">zeImageGetDeviceOffsetExp</span></a></p></li>
</ul>
</div></blockquote>
</li>
</ul>
<div class="section" id="bindless-images">
<h3>Bindless Images<a class="headerlink" href="#bindless-images" title="Permalink to this headline">¶</a></h3>
<p>A bindless image is defined as one which provides access to the underlying data via image reference handles.
At the application level, this allows the user to implement programs where the number of images is not known at
compile-time, and store all handles to images irrespective of varying formats and layouts in some container such as a dynamic array.</p>
<p>Currently, in Level Zero, <cite>zeImageCreate</cite> performs the image memory allocation and image handle generation.
This function only allows for the allocation of image memory in an implementation-specific layout.</p>
<dl class="simple">
<dt>In this extension, we propose the following additions:</dt><dd><ul class="simple">
<li><p>Provide a new image descriptor and flags for Bindless images.</p></li>
<li><p>Support for creation of images on linearly allocated memory backed by USM.</p></li>
<li><p>Extension API to create an image handle from pitched memory</p></li>
</ul>
</dd>
</dl>
<p>A “Bindless image” can be created by passing <a class="reference internal" href="api.html#ze-image-bindless-exp-desc-t"><span class="std std-ref">ze_image_bindless_exp_desc_t</span></a> to pNext member of
<a class="reference internal" href="api.html#ze-image-desc-t"><span class="std std-ref">ze_image_desc_t</span></a> and set the flags value as <a class="reference internal" href="api.html#ze-image-bindless-exp-flags-t"><span class="std std-ref">ZE_IMAGE_BINDLESS_EXP_FLAG_BINDLESS</span></a></p>
<p>This extension is complimentary to and may be used in conjunction with the <a class="reference external" href="https://spec.oneapi.io/level-zero/latest/core/EXT_ImageView.html#image-view-extension">ZE_extension_image_view</a> extension</p>
</div>
<div class="section" id="programming-example-with-bindless-images">
<h3>Programming example with Bindless images<a class="headerlink" href="#programming-example-with-bindless-images" title="Permalink to this headline">¶</a></h3>
<pre class="literal-block">// Assumed image data on host
std::vector&lt;float&gt; imageDataHost;

// 2D image dimensions
size_t imageWidth = 1024;
size_t imageHeight = 1024;

// Single-precision float image format with one channel
<a class="reference internal" href="api.html#ze-image-format-t"><span class="std std-ref">ze_image_format_t</span></a> imageFormat = {
    ZE_IMAGE_FORMAT_LAYOUT_32, ZE_IMAGE_FORMAT_TYPE_FLOAT,
    ZE_IMAGE_FORMAT_SWIZZLE_R, ZE_IMAGE_FORMAT_SWIZZLE_X,
    ZE_IMAGE_FORMAT_SWIZZLE_R, ZE_IMAGE_FORMAT_SWIZZLE_X
}

// Create an image descriptor for bindless image
<a class="reference internal" href="api.html#ze-image-desc-t"><span class="std std-ref">ze_image_desc_t</span></a> imageDesc = {
    ZE_STRUCTURE_TYPE_IMAGE_DESC,
    nullptr,
    0,
    ZE_IMAGE_TYPE_2D,
    imageFormat,
    128, 128, 0, 0, 0
};

<a class="reference internal" href="api.html#ze-image-bindless-exp-desc-t"><span class="std std-ref">ze_image_bindless_exp_desc_t</span></a> bindlessImageDesc = {<a class="reference internal" href="api.html#ze-structure-type-t"><span class="std std-ref">ZE_STRUCTURE_TYPE_BINDLESS_IMAGE_EXP_DESC</span></a>};
bindlessImageDesc.flags = <a class="reference internal" href="api.html#ze-image-bindless-exp-flags-t"><span class="std std-ref">ZE_IMAGE_BINDLESS_EXP_FLAG_BINDLESS</span></a>;
imageDesc.pNext = &amp;bindlessImageDesc;

// A bindless image is valid on both host and device and can be passed into kernels
// When passing <a class="reference internal" href="api.html#ze-image-bindless-exp-flags-t"><span class="std std-ref">ZE_IMAGE_BINDLESS_EXP_FLAG_BINDLESS</span></a> to zeImageCreate, only the backing memory is allocated for Image
ze_image_handle_t hImage;
<a class="reference internal" href="api.html#zeimagecreate"><span class="std std-ref">zeImageCreate</span></a>(hContext, hDevice, &amp;imageDesc, &amp;hImage);

//Copy To new bindless image memory
<a class="reference internal" href="api.html#zecommandlistappendimagecopyfrommemory"><span class="std std-ref">zeCommandListAppendImageCopyFromMemory</span></a>(hCommandlist, hImage, imageDataHost.data(), nullptr, nullptr, 0, nullptr);

// Launch kernel and perform appropriate synchronizations

// Copy back
<a class="reference internal" href="api.html#zecommandlistappendimagecopytomemory"><span class="std std-ref">zeCommandListAppendImageCopyToMemory</span></a>(hCommandlist, imageDataHost.data(), hImage, nullptr, nullptr, 0, nullptr);

// Further image views can be created from the existing memory allocated using bindless flags
ze_image_handle_t hImageView;
<a class="reference internal" href="api.html#zeimageviewcreateext"><span class="std std-ref">zeImageViewCreateExt</span></a>(hContext, hDevice, &amp;imageDesc, hImage, &amp;hImageView);

// New image view can be separately used by users and destroyed
// ...

// Once all operations are complete we need destroy bindless image handle(s)
<a class="reference internal" href="api.html#zeimagedestroy"><span class="std std-ref">zeImageDestroy</span></a>(hImageView);
<a class="reference internal" href="api.html#zeimagedestroy"><span class="std std-ref">zeImageDestroy</span></a>(hImage);</pre>
</div>
<div class="section" id="programming-example-with-pitched-memory-usage">
<h3>Programming example with pitched memory usage<a class="headerlink" href="#programming-example-with-pitched-memory-usage" title="Permalink to this headline">¶</a></h3>
<pre class="literal-block">// Retrieve pitched alloc properties specific to device
<a class="reference internal" href="api.html#ze-device-image-properties-t"><span class="std std-ref">ze_device_image_properties_t</span></a> deviceImageProperties = {};
<a class="reference internal" href="api.html#ze-device-pitched-alloc-exp-properties-t"><span class="std std-ref">ze_device_pitched_alloc_exp_properties_t</span></a> pitchedAllocProperties = {};
pitchedAllocProperties.stype  = <a class="reference internal" href="api.html#ze-structure-type-t"><span class="std std-ref">ZE_STRUCTURE_TYPE_PITCHED_ALLOC_DEVICE_EXP_PROPERTIES</span></a>

deviceImageProperties.pNext = &amp;pitchedAllocProperties;
<a class="reference internal" href="api.html#zedevicegetimageproperties"><span class="std std-ref">zeDeviceGetImageProperties</span></a>(hDevice, &amp;deviceImageProperties);

// Assumed image data on host
std::vector&lt;float&gt; imageDataHost;

// 2D image dimensions
size_t imageWidth = 1024;
size_t imageHeight = 1024;

//Pitched memory in linear layout
size_t rowPitch;
unsigned int elementSize = 128;
<a class="reference internal" href="api.html#zememgetpitchfor2dimage"><span class="std std-ref">zeMemGetPitchFor2dImage</span></a>(hContext, hDevice, imageWidth, imageHeight, elementSize, &amp;rowPitch);
size_t allocSize = rowPitch * imageHeight;
<a class="reference internal" href="api.html#ze-device-mem-alloc-desc-t"><span class="std std-ref">ze_device_mem_alloc_desc_t</span></a> allocDesc = {<a class="reference internal" href="api.html#ze-structure-type-t"><span class="std std-ref">ZE_STRUCTURE_TYPE_DEVICE_MEM_ALLOC_DESC</span></a>};
<a class="reference internal" href="api.html#zememallocdevice"><span class="std std-ref">zeMemAllocDevice</span></a>(hContext, &amp;allocDesc, allocSize, allocSize, hDevice, &amp;pitchedPtr);

// Declare the copy region for copying
<a class="reference internal" href="api.html#ze-copy-region-t"><span class="std std-ref">ze_copy_region_t</span></a> copyRegion = {0, 0, 0, imageWidth * sizeof(float), imageHeight, 0};

// Copy from host to device
<a class="reference internal" href="api.html#zecommandlistappendmemorycopyregion"><span class="std std-ref">zeCommandListAppendMemoryCopyRegion</span></a>(hCommandList, pitchedPtr, &amp;copyRegion, rowPitch, 0, imageDataHost.data(), &amp;copyRegion, imageWidth * sizeof(float), 0, nullptr, 0, nullptr);

// Single-precision float image format with one channel
<a class="reference internal" href="api.html#ze-image-format-t"><span class="std std-ref">ze_image_format_t</span></a> imageFormat = {
    ZE_IMAGE_FORMAT_LAYOUT_32, ZE_IMAGE_FORMAT_TYPE_FLOAT,
    ZE_IMAGE_FORMAT_SWIZZLE_R, ZE_IMAGE_FORMAT_SWIZZLE_X,
    ZE_IMAGE_FORMAT_SWIZZLE_R, ZE_IMAGE_FORMAT_SWIZZLE_X
}

// Create an image descriptor for bindless image
<a class="reference internal" href="api.html#ze-image-desc-t"><span class="std std-ref">ze_image_desc_t</span></a> imageDesc = {
    ZE_STRUCTURE_TYPE_IMAGE_DESC,
    nullptr,
    0,
    ZE_IMAGE_TYPE_2D,
    imageFormat,
    128, 128, 0, 0, 0
};

<a class="reference internal" href="api.html#ze-image-pitched-exp-desc-t"><span class="std std-ref">ze_image_pitched_exp_desc_t</span></a> pitchedImageDesc = {<a class="reference internal" href="api.html#ze-structure-type-t"><span class="std std-ref">ZE_STRUCTURE_TYPE_PITCHED_IMAGE_EXP_DESC</span></a>};
pitchedImageDesc.ptr = pitchedPtr;
imageDesc.pNext = &amp;pitchedImageDesc;

// A image created out of pitched memory is valid on both host and device and can be passed into kernels
ze_image_handle_t hImage;
<a class="reference internal" href="api.html#zeimagecreate"><span class="std std-ref">zeImageCreate</span></a>(hContext, hDevice, &amp;imageDesc, &amp;hImage);

// Launch kernel and perform appropriate synchronizations

// ...

// Copy from device to host
<a class="reference internal" href="api.html#zecommandlistappendmemorycopyregion"><span class="std std-ref">zeCommandListAppendMemoryCopyRegion</span></a>(hCommandList, imageDataHost.data(), &amp;copyRegion, imageWidth * sizeof(float), 0, pitchedPtr, &amp;copyRegion, rowPitch, 0, nullptr, 0, nullptr);

// Once all operations on the image are complete we need destroy image handle and free memory
<a class="reference internal" href="api.html#zeimagedestroy"><span class="std std-ref">zeImageDestroy</span></a>(hImage);
<a class="reference internal" href="api.html#zememfree"><span class="std std-ref">zeMemFree</span></a>(hContext, pitchedPtr);</pre>
</div>
</div>
</div>


              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Intel<br/>
    
        &copy; Copyright 2024, Intel.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>